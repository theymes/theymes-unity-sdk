!function(e){"use strict";var n=function(){return n=Object.assign||function(e){for(var n,t=1,o=arguments.length;t<o;t++)for(var i in n=arguments[t])Object.prototype.hasOwnProperty.call(n,i)&&(e[i]=n[i]);return e},n.apply(this,arguments)};function t(e,n,t,o){return new(t||(t=Promise))(function(i,r){function a(e){try{l(o.next(e))}catch(e){r(e)}}function s(e){try{l(o.throw(e))}catch(e){r(e)}}function l(e){var n;e.done?i(e.value):(n=e.value,n instanceof t?n:new t(function(e){e(n)})).then(a,s)}l((o=o.apply(e,n||[])).next())})}function o(e,n){var t,o,i,r={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]},a=Object.create(("function"==typeof Iterator?Iterator:Object).prototype);return a.next=s(0),a.throw=s(1),a.return=s(2),"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a;function s(s){return function(l){return function(s){if(t)throw new TypeError("Generator is already executing.");for(;a&&(a=0,s[0]&&(r=0)),r;)try{if(t=1,o&&(i=2&s[0]?o.return:s[0]?o.throw||((i=o.return)&&i.call(o),0):o.next)&&!(i=i.call(o,s[1])).done)return i;switch(o=0,i&&(s=[2&s[0],i.value]),s[0]){case 0:case 1:i=s;break;case 4:return r.label++,{value:s[1],done:!1};case 5:r.label++,o=s[1],s=[0];continue;case 7:s=r.ops.pop(),r.trys.pop();continue;default:if(!(i=r.trys,(i=i.length>0&&i[i.length-1])||6!==s[0]&&2!==s[0])){r=0;continue}if(3===s[0]&&(!i||s[1]>i[0]&&s[1]<i[3])){r.label=s[1];break}if(6===s[0]&&r.label<i[1]){r.label=i[1],i=s;break}if(i&&r.label<i[2]){r.label=i[2],r.ops.push(s);break}i[2]&&r.ops.pop(),r.trys.pop();continue}s=n.call(e,r)}catch(e){s=[6,e],o=0}finally{t=i=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}([s,l])}}}function i(e,n,t){if(t||2===arguments.length)for(var o,i=0,r=n.length;i<r;i++)!o&&i in n||(o||(o=Array.prototype.slice.call(n,0,i)),o[i]=n[i]);return e.concat(o||Array.prototype.slice.call(n))}"function"==typeof SuppressedError&&SuppressedError;var r={unreadMessageCountUpdate:new Set,unansweredMessageCountUpdate:new Set,open:new Set,close:new Set};function a(e,n){r[e].add(n)}function s(e,n){r[e].delete(n)}function l(e,n){r[e].forEach(function(e){return e.apply(void 0,n)})}var c='<!DOCTYPE html>\n<html lang="en">\n\n<head>\n  <meta charset="utf-8" />\n  <meta name="viewport"\n    content="viewport-fit=cover, width=device-width, initial-scale=1.0, minimum-scale=1.0, maximum-scale=1.0, user-scalable=no" />\n  <meta name="theme-color" content="#000000" />\n  <meta name="robots" content="noindex" />\n  <title>Theymes</title>\n  <style NONCE_ATTR_PLACEHOLDER>\n    * {\n      box-sizing: border-box;\n    }\n\n    html {\n      font-family: sans-serif;\n      font-size: CSS_FONT_SIZE_PLACEHOLDER;\n    }\n\n    html,\n    body {\n      background: rgb(CSS_BACKGROUND_PLACEHOLDER);\n      width: 100%;\n      height: 100%;\n      margin: 0;\n      padding: 0;\n      -webkit-tap-highlight-color: transparent;\n      -webkit-touch-callout: none;\n      -webkit-user-select: none;\n      -khtml-user-select: none;\n      -moz-user-select: none;\n      -ms-user-select: none;\n      user-select: none;\n      touch-action: none;\n    }\n\n    .wrapper {\n      display: flex;\n      flex-direction: column;\n      width: 100%;\n      height: 100%;\n      padding-top: INSET_TOP_PLACEHOLDER;\n      padding-bottom: INSET_BOTTOM_PLACEHOLDER;\n      padding-left: INSET_LEFT_PLACEHOLDER;\n      padding-right: INSET_RIGHT_PLACEHOLDER;\n    }\n\n    .top-bar {\n      flex: 0 0 auto;\n      display: flex;\n      width: 100%;\n      align-items: center;\n      justify-content: flex-end;\n    }\n\n    .close-button {\n      padding: 0.5rem 1rem;\n      cursor: pointer;\n    }\n\n    .close-button svg {\n      display: block;\n      stroke: rgb(CSS_ACCENT_PLACEHOLDER);\n      width: 1.75rem;\n      height: 1.75rem;\n    }\n\n    .error-wrapper {\n      flex: 1 0 0%;\n      display: flex;\n      flex-direction: column;\n      width: 100%;\n      height: 100%;\n      position: relative;\n      align-items: center;\n      justify-content: center;\n      text-align: center;\n      gap: 12px;\n      padding: 12px;\n    }\n\n    h1 {\n      font-size: 18px;\n      font-weight: 400;\n      color: rgb(CSS_TEXT_PLACEHOLDER);\n    }\n\n    svg.error-icon {\n      stroke: rgb(CSS_ACCENT_PLACEHOLDER);\n    }\n  </style>\n</head>\n\n<body>\n  <noscript>You need to enable JavaScript to run this app.</noscript>\n  <div class="wrapper">\n    <div class="top-bar">\n      <div class="close-button">\n        <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none"\n          stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"\n          class="lucide lucide-x-icon lucide-x">\n          <path d="M18 6 6 18" />\n          <path d="m6 6 12 12" />\n        </svg>\n      </div>\n    </div>\n    <div class="error-wrapper">\n      <svg class="error-icon" width="91" height="91" viewBox="0 0 91 91" fill="none" xmlns="http://www.w3.org/2000/svg">\n        <path\n          d="M45.1079 89.1321C50.7158 89.1321 55.2618 84.5859 55.2618 78.9783C55.2618 73.3707 50.7158 68.8245 45.1079 68.8245C39.5001 68.8245 34.9541 73.3707 34.9541 78.9783C34.9541 84.5859 39.5001 89.1321 45.1079 89.1321Z"\n          stroke="#FFB547" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" />\n        <path d="M24.7637 58.6355C35.9988 47.4005 54.2144 47.4005 65.4492 58.6355" stroke="#FFB547" stroke-width="2"\n          stroke-linecap="round" stroke-linejoin="round" />\n        <path d="M12.7988 46.6689C22.1436 37.3241 34.529 32.8731 46.7703 33.3159" stroke="#FFB547" stroke-width="2"\n          stroke-linecap="round" stroke-linejoin="round" />\n        <path d="M1.1084 34.4283C11.6674 23.9971 25.012 18.0833 38.7295 16.6868" stroke="#FFB547" stroke-width="2"\n          stroke-linecap="round" stroke-linejoin="round" />\n        <path d="M89.1082 1.13208L62.0312 28.209" stroke="#FFB547" stroke-width="2" stroke-linecap="round"\n          stroke-linejoin="round" />\n        <path d="M62.0312 1.13208L89.1082 28.209" stroke="#FFB547" stroke-width="2" stroke-linecap="round"\n          stroke-linejoin="round" />\n      </svg>\n      <div>\n        <h1>Connection error</h1>\n      </div>\n    </div>\n  </div>\n  <script NONCE_ATTR_PLACEHOLDER>\n    function closeTheymesSdk() {\n      parent.postMessage({ action: \'theymes.close\' }, \'*\');\n    }\n\n    document.querySelector(\'.close-button\').addEventListener(\'click\', closeTheymesSdk);\n  <\/script>\n</body>\n\n</html>',d="1.2.13",u="colors",g="locs",f="fonts",p="recordRetentionAfterSecs",m="resetSessionAfterSecs",h="web",v={sdkDialog:"#theymes-sdk-dialog",sdkIframeWrapper:"#theymes-sdk-wrapper",sdkIframe:"#theymes-sdk",sdkLoaderIframe:"#theymes-sdk-loader",notificationDialog:"#theymes-sdk-notification-dialog",notificationIframe:"#theymes-sdk-notification",sdkButtonIframe:"#theymes-sdk-button",sdkStylesheet:"#theymes-sdk-stylesheet"},y=.2,b="theymes_path_on_init",w=function(e){var n;try{return null!==(n=null===localStorage||void 0===localStorage?void 0:localStorage.getItem(e))&&void 0!==n?n:null}catch(e){return null}},S=function(e,n){try{null===localStorage||void 0===localStorage||localStorage.setItem(e,n)}catch(e){}},E={length:0,getItem:function(e){var n;try{return null!==(n=null===sessionStorage||void 0===sessionStorage?void 0:sessionStorage.getItem(e))&&void 0!==n?n:null}catch(e){return null}},setItem:function(e,n){try{null===sessionStorage||void 0===sessionStorage||sessionStorage.setItem(e,n)}catch(e){}},removeItem:function(e){try{null===sessionStorage||void 0===sessionStorage||sessionStorage.removeItem(e)}catch(e){}},clear:function(){try{null===sessionStorage||void 0===sessionStorage||sessionStorage.clear()}catch(e){}},key:function(e){var n;try{return null!==(n=null===sessionStorage||void 0===sessionStorage?void 0:sessionStorage.key(e))&&void 0!==n?n:null}catch(e){return null}}},x=function(){var e=null,t=28800,o={text:{r:255,g:255,b:255},border:{r:51,g:54,b:71},background:{r:12,g:15,b:20},tile:{r:20,g:23,b:29},accent:{r:255,g:181,b:71},notificationBackground:{r:20,g:23,b:29},notificationText:{r:255,g:255,b:255},widgetButtonBackground:{r:12,g:15,b:20},widgetButtonText:{r:12,g:15,b:20},widgetButtonActionPending:{r:255,g:65,b:65}},i={widgetButtonText:{}},r=T();try{e=function(){var e=w(p);if(e){var n=JSON.parse(e);if("number"==typeof n)return n}return null}(),t=function(){var e=w(m);if(e){var n=JSON.parse(e);if("number"==typeof n)return n}return k()}(),o=function(){var e=w(u);if(e){var t=JSON.parse(e);return n(n({},{text:{r:255,g:255,b:255},border:{r:51,g:54,b:71},background:{r:12,g:15,b:20},tile:{r:20,g:23,b:29},accent:{r:255,g:181,b:71},notificationBackground:{r:20,g:23,b:29},notificationText:{r:255,g:255,b:255},widgetButtonBackground:{r:12,g:15,b:20},widgetButtonText:{r:12,g:15,b:20},widgetButtonActionPending:{r:255,g:65,b:65}}),t)}return{text:{r:255,g:255,b:255},border:{r:51,g:54,b:71},background:{r:12,g:15,b:20},tile:{r:20,g:23,b:29},accent:{r:255,g:181,b:71},notificationBackground:{r:20,g:23,b:29},notificationText:{r:255,g:255,b:255},widgetButtonBackground:{r:12,g:15,b:20},widgetButtonText:{r:12,g:15,b:20},widgetButtonActionPending:{r:255,g:65,b:65}}}(),i=function(){var e=w(g);if(e){var t=JSON.parse(e);return n(n({},{widgetButtonText:{}}),t)}return{widgetButtonText:{}}}(),r=function(){var e=w(f);if(e){var t=JSON.parse(e);return n(n({},T()),t)}return T()}()}catch(e){console.error("Error initializing internals",e)}return{token:null,domain:null,mode:"game",deviceId:null,position:"bottom-right",widgetButton:!1,widgetButtonAction:"support",x:20,y:20,loggingEnabled:!1,element:null,language:null,userLanguage:navigator.language,tags:new Set,fields:{},youngPlayer:!1,privacyMode:!1,signedMetadataToken:null,isLoggedIn:!1,isInForeground:!0,hasNetworkConnectivity:!0,player:null,sdkIsOpen:!1,forceUpdateSdkDialog:!1,recordRetentionAfterSecs:e,resetSessionAfterSecs:t,sessionStatus:"waiting",sessionStartTime:null,sessionResumeOrStartTime:null,retentionRemainingSeconds:null,isRetentionRecordedForSession:!1,recordRetentionTimerId:null,retryRecordRetentionTimerId:null,retryIntervalSecs:300,networkErrorTimerId:null,colors:o,locs:i,fonts:r,notificationsPaused:!0,notifications:[],visibleNotification:null,unreadMessageCount:0,unansweredMessageCount:0,previousPath:null,previousConfig:null,nonce:null,keyboardHeight:0,disableInsets:!1}}();function T(){return{body:void 0}}function k(){return 28800}var C=function(e,n){return e===n||Boolean(e&&n&&"object"==typeof e&&"object"==typeof n&&Object.keys(e).length===Object.keys(n).length&&Object.entries(e).every(function(e){var t=e[0],o=e[1];return C(o,n[t])}))};function O(e){var n,t=e.iframe,o=e.content,i=null===(n=t.contentWindow)||void 0===n?void 0:n.document;i&&(i.open(),i.write(o),i.close())}function L(e){return"".concat(e.r,", ").concat(e.g,", ").concat(e.b)}function I(e){var n,t,o,i;return e.template.replace(/PLATFORM_PLACEHOLDER/g,h).replace(/INSET_TOP_PLACEHOLDER/g,x.disableInsets?"0px":"env(safe-area-inset-top, 0px)").replace(/INSET_BOTTOM_PLACEHOLDER/g,x.disableInsets?"0px":"env(safe-area-inset-bottom, 0px)").replace(/INSET_LEFT_PLACEHOLDER/g,x.disableInsets?"0px":"env(safe-area-inset-left, 0px)").replace(/INSET_RIGHT_PLACEHOLDER/g,x.disableInsets?"0px":"env(safe-area-inset-right, 0px)").replace(/CSS_TEXT_PLACEHOLDER/g,L(x.colors.text)).replace(/CSS_BORDER_PLACEHOLDER/g,L(x.colors.border)).replace(/CSS_BACKGROUND_PLACEHOLDER/g,L(x.colors.background)).replace(/CSS_TILE_PLACEHOLDER/g,L(x.colors.tile)).replace(/CSS_ACCENT_PLACEHOLDER/g,L(x.colors.accent)).replace(/CSS_NOTIFICATION_BACKGROUND_PLACEHOLDER/g,L(x.colors.notificationBackground)).replace(/CSS_NOTIFICATION_TEXT_PLACEHOLDER/g,L(x.colors.notificationText)).replace(/CSS_FONT_SIZE_PLACEHOLDER/g,"game"===x.mode?"16px":"14px").replace(/CSS_BODY_FONT_NORMAL_SRC_PLACEHOLDER/g,null!==(t=null===(n=x.fonts.body)||void 0===n?void 0:n.regular)&&void 0!==t?t:"url('https://fonts.gstatic.com/s/poppins/v22/pxiEyp8kv8JHgFVrJJfecnFHGPc.woff2') format('woff2')").replace(/CSS_BODY_FALLBACK_FONT_FAMILY_PLACEHOLDER/g,null!==(i=null===(o=x.fonts.body)||void 0===o?void 0:o.fallback)&&void 0!==i?i:"ui-sans-serif, system-ui, sans-serif").replace(/NONCE_ATTR_PLACEHOLDER/g,x.nonce?'nonce="'.concat(x.nonce,'"'):"")}var _=function(e,n,t){return function(){for(var o=[],i=0;i<arguments.length;i++)o[i]=arguments[i];try{return n.apply(void 0,o)}catch(n){return console.error("Error in ".concat(e),n),t}}},R=function(e){var n=e.split(/[-_]/),t=n[0],o=n[1];return t?o?"".concat(t.toLowerCase(),"-").concat(o.toUpperCase()):t.toLowerCase():"en"},P=/(android|bb\d+|meego).+mobile|armv7l|avantgo|bada\/|blackberry|blazer|compal|elaine|fennec|hiptop|iemobile|ip(hone|od)|iris|kindle|lge |maemo|midp|mmp|mobile.+firefox|netfront|opera m(ob|in)i|palm( os)?|phone|p(ixi|re)\/|plucker|pocket|psp|redmi|series[46]0|samsungbrowser.*mobile|symbian|treo|up\.(browser|link)|vodafone|wap|windows (ce|phone)|xda|xiino/i,A=/CrOS/,N=/android|ipad|playbook|silk/i;function D(){return!!function(e){e||(e={});var n=e.ua;if(n||"undefined"==typeof navigator||(n=navigator.userAgent),n&&n.headers&&"string"==typeof n.headers["user-agent"]&&(n=n.headers["user-agent"]),"string"!=typeof n)return!1;var t=P.test(n)&&!A.test(n)||!!e.tablet&&N.test(n);return!t&&e.tablet&&e.featureDetect&&navigator&&navigator.maxTouchPoints>1&&-1!==n.indexOf("Macintosh")&&-1!==n.indexOf("Safari")&&(t=!0),t}({tablet:!0})&&(window.innerWidth<500||window.innerHeight<500)}function B(e){var n=e.type,t=x.position,o=x.x,i=x.y;return D()&&"widget"===n?{top:"0",left:"0",right:"0",bottom:"0"}:"top-left"===t?{top:"".concat(o,"px"),left:"".concat(i,"px"),right:"auto",bottom:"auto"}:"top-right"===t?{top:"".concat(o,"px"),right:"".concat(i,"px"),left:"auto",bottom:"auto"}:"bottom-left"===t?{bottom:"".concat(o,"px"),left:"".concat(i,"px"),right:"auto",top:"auto"}:{bottom:"".concat(o,"px"),right:"".concat(i,"px"),left:"auto",top:"auto"}}function M(){return D()?{width:"100%",height:"100%",maxWidth:"none",maxHeight:"none"}:{width:"".concat(340,"px"),height:"".concat(680,"px"),maxWidth:"none",maxHeight:"calc(100vh - ".concat(2*x.y,"px)")}}function H(e){var n=document.querySelector(v.sdkButtonIframe);if(n)var t=setInterval(function(){var o,i;"complete"===(null===(o=n.contentDocument)||void 0===o?void 0:o.readyState)&&(clearInterval(t),null===(i=null==n?void 0:n.contentWindow)||void 0===i||i.postMessage(e,"*"))},100)}function F(){var e,n,t=x.notifications[0];if(t&&!x.visibleNotification){x.visibleNotification=t;var o=null!==(e=document.querySelector(v.notificationDialog))&&void 0!==e?e:document.createElement("div");o.id=v.notificationDialog.replace("#",""),o.style.position="fixed",o.style.border="none",o.style.margin="0",o.style.padding="0",o.style.zIndex="9999",o.style.colorScheme="auto",o.style.backgroundColor="transparent",o.style.pointerEvents="none",o.style.overflow="hidden",document.body.appendChild(o);var i,r=null!==(n=o.querySelector(v.notificationIframe))&&void 0!==n?n:document.createElement("iframe");r.id=v.notificationIframe.replace("#",""),r.style.position="absolute",r.style.border="none",r.style.width="0",r.style.height="0",r.style.top="-20px",r.style.left="0",r.style.colorScheme="auto",r.style.pointerEvents="auto",r.style.marginTop="-20px",r.style.opacity="0",r.style.transition="opacity ".concat(.2,"s ease-in-out, margin-top ").concat(.2,"s ease-in-out"),o.appendChild(r),O({iframe:r,content:(i={text:t.text},I({template:'<!DOCTYPE html>\n<html lang="en">\n\n<head>\n  <meta charset="utf-8" />\n  <meta name="viewport"\n    content="viewport-fit=cover, width=device-width, initial-scale=1.0, minimum-scale=1.0, maximum-scale=1.0, user-scalable=no" />\n  <meta name="theme-color" content="#000000" />\n  <meta name="robots" content="noindex" />\n  <title>Theymes</title>\n  <style NONCE_ATTR_PLACEHOLDER>\n    @font-face {\n      font-family: \'TheymesBody\';\n      src: CSS_BODY_FONT_NORMAL_SRC_PLACEHOLDER;\n      font-weight: normal;\n      font-style: normal;\n      font-display: fallback;\n    }\n\n    * {\n      box-sizing: border-box;\n    }\n\n    html {\n      font-family: \'TheymesBody\', CSS_BODY_FALLBACK_FONT_FAMILY_PLACEHOLDER;\n    }\n\n    html,\n    body {\n      width: 100%;\n      height: auto;\n      margin: 0;\n      padding: 0;\n      -webkit-tap-highlight-color: transparent;\n      -webkit-touch-callout: none;\n      -webkit-user-select: none;\n      -khtml-user-select: none;\n      -moz-user-select: none;\n      -ms-user-select: none;\n      user-select: none;\n      touch-action: none;\n    }\n\n    .close-button svg {\n      display: block;\n      stroke: rgb(CSS_NOTIFICATION_TEXT_PLACEHOLDER);\n      width: 1.25rem;\n      height: 1.25rem;\n    }\n\n    .notification {\n      display: flex;\n      flex-direction: row;\n      align-items: center;\n      justify-content: space-between;\n      background: rgb(CSS_NOTIFICATION_BACKGROUND_PLACEHOLDER);\n      width: 100%;\n      height: auto;\n      margin: 0;\n      padding: 12px;\n      border-radius: 6px;\n      color: rgb(CSS_NOTIFICATION_TEXT_PLACEHOLDER);\n    }\n\n    .notification-text {\n      flex: 1 0 0%;\n      font-size: 0.875rem;\n      /* 14/16 */\n      line-height: 1.2;\n      display: -webkit-box;\n      line-clamp: 2;\n      -webkit-line-clamp: 2;\n      -webkit-box-orient: vertical;\n      overflow: hidden;\n      text-overflow: ellipsis;\n      cursor: pointer;\n    }\n\n    .close-button {\n      flex: 0 0 auto;\n      padding-left: 10px;\n      cursor: pointer;\n    }\n  </style>\n</head>\n\n<body>\n  <noscript>You need to enable JavaScript to run this app.</noscript>\n  <div class="notification">\n    <div class="notification-text">NOTIFICATION_TEXT_PLACEHOLDER</div>\n    <div class="close-button">\n      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"\n        stroke-linecap="round" stroke-linejoin="round">\n        <path d="M18 6 6 18"></path>\n        <path d="m6 6 12 12"></path>\n      </svg>\n    </div>\n  </div>\n  <script NONCE_ATTR_PLACEHOLDER>\n    function closeNotification() {\n      parent.postMessage({ action: \'theymes.closeNotification\' }, \'*\');\n    }\n\n    function notificationClicked() {\n      parent.postMessage({ action: \'theymes.handleNotificationAction\' }, \'*\');\n    }\n\n    document.querySelector(\'.notification-text\').addEventListener(\'click\', notificationClicked);\n    document.querySelector(\'.close-button\').addEventListener(\'click\', closeNotification);\n  <\/script>\n</body>\n\n</html>'}).replace(/NOTIFICATION_TEXT_PLACEHOLDER/g,i.text))}),setTimeout(function(){r.style.opacity="1",r.style.marginTop="0px",j()},500),t.closeAfterSeconds>0&&setTimeout(function(){U({notification:t})},1e3*t.closeAfterSeconds)}}function j(){var e,n,t,o=document.querySelector(v.notificationDialog),i=document.querySelector(v.notificationIframe);if(o&&i){var r=(null===(t=null===(n=null===(e=i.contentWindow)||void 0===e?void 0:e.document)||void 0===n?void 0:n.body)||void 0===t?void 0:t.scrollHeight)?"".concat(i.contentWindow.document.body.scrollHeight,"px"):"0";if("widget"===x.mode){var a=B({type:"widget"}),s=M(),l="calc(".concat(s.width," - 20px)");o.style.bottom=a.bottom,o.style.right=a.right,o.style.left=a.left,o.style.top=a.top,o.style.overflow="hidden",i.style.width=l}else if(x.element){var c=x.element.getBoundingClientRect();l="".concat(c.width-20,"px");o.style.top="".concat(c.top,"px"),o.style.left="".concat(c.left,"px"),o.style.right="".concat(c.right,"px"),o.style.bottom="".concat(c.bottom,"px"),o.style.overflow="hidden",i.style.width=l}else{l="calc(100% - 20px)";o.style.top=x.disableInsets?"0px":"env(safe-area-inset-top, 0px)",o.style.left=x.disableInsets?"0px":"env(safe-area-inset-left, 0px)",o.style.right=x.disableInsets?"0px":"env(safe-area-inset-right, 0px)",o.style.bottom=x.disableInsets?"0px":"env(safe-area-inset-bottom, 0px)",o.style.overflow="visible",i.style.width=l}i.style.height=r,i.style.top="10px",i.style.left="10px"}}function U(e){if(e.notification&&x.visibleNotification===e.notification){var n=document.querySelector(v.notificationIframe),t=document.querySelector(v.notificationDialog);n&&(n.style.opacity="0",n.style.marginTop="-20px",setTimeout(function(){null==t||t.remove(),x.notifications=x.notifications.slice(1),x.visibleNotification=null,F()},200))}}var q=function(){function e(){Object.defineProperty(this,"isRunning",{enumerable:!0,configurable:!0,writable:!0,value:!1}),Object.defineProperty(this,"timer",{enumerable:!0,configurable:!0,writable:!0,value:null}),Object.defineProperty(this,"pollWhenNotificationsEnabled",{enumerable:!0,configurable:!0,writable:!0,value:!0}),Object.defineProperty(this,"lastPollDate",{enumerable:!0,configurable:!0,writable:!0,value:null}),Object.defineProperty(this,"nextPollDate",{enumerable:!0,configurable:!0,writable:!0,value:null}),this.resumeIfNeeded(!1)}return Object.defineProperty(e.prototype,"onIsInForegroundChanged",{enumerable:!1,configurable:!0,writable:!0,value:function(){x.isInForeground?this.resumeIfNeeded(!1):this.pauseIfNeeded()}}),Object.defineProperty(e.prototype,"onHasNetworkConnectivityChanged",{enumerable:!1,configurable:!0,writable:!0,value:function(){this.resumeIfNeeded(!1)}}),Object.defineProperty(e.prototype,"resume",{enumerable:!1,configurable:!0,writable:!0,value:function(e){this.isRunning=!0;var n=new Date;if(this.nextPollDate&&!e||(this.nextPollDate=new Date(n.getTime()+1e3)),n>=this.nextPollDate)this.pollEventsRequest();else{var t=(this.nextPollDate.getTime()-n.getTime())/1e3;this.scheduleNextPollEventsRequest(t)}}}),Object.defineProperty(e.prototype,"pause",{enumerable:!1,configurable:!0,writable:!0,value:function(){this.isRunning=!1,this.timer&&(clearTimeout(this.timer),this.timer=null)}}),Object.defineProperty(e.prototype,"shouldBeRunning",{enumerable:!1,configurable:!0,writable:!0,value:function(){return x.isLoggedIn&&x.isInForeground&&x.hasNetworkConnectivity&&!x.sdkIsOpen}}),Object.defineProperty(e.prototype,"resumeIfNeeded",{enumerable:!1,configurable:!0,writable:!0,value:function(e){!this.shouldBeRunning()||this.isRunning&&!e||this.resume(e)}}),Object.defineProperty(e.prototype,"pauseIfNeeded",{enumerable:!1,configurable:!0,writable:!0,value:function(){this.isRunning&&!this.shouldBeRunning()&&this.pause()}}),Object.defineProperty(e.prototype,"onEnableNotifications",{enumerable:!1,configurable:!0,writable:!0,value:function(){this.isRunning&&this.pollWhenNotificationsEnabled&&this.scheduleNextPollEventsRequest(0)}}),Object.defineProperty(e.prototype,"onOpen",{enumerable:!1,configurable:!0,writable:!0,value:function(){this.pauseIfNeeded()}}),Object.defineProperty(e.prototype,"onClose",{enumerable:!1,configurable:!0,writable:!0,value:function(){this.resumeIfNeeded(!0)}}),Object.defineProperty(e.prototype,"onLogin",{enumerable:!1,configurable:!0,writable:!0,value:function(){this.resumeIfNeeded(!0)}}),Object.defineProperty(e.prototype,"onLogout",{enumerable:!1,configurable:!0,writable:!0,value:function(){this.pauseIfNeeded()}}),Object.defineProperty(e.prototype,"scheduleNextPollEventsRequest",{enumerable:!1,configurable:!0,writable:!0,value:function(e){var n=this;this.nextPollDate=new Date(Date.now()+1e3*e),this.timer&&clearTimeout(this.timer),this.timer=setTimeout(function(){n.timer=null,n.pollEventsRequest()},1e3*e)}}),Object.defineProperty(e.prototype,"pollEventsRequest",{enumerable:!1,configurable:!0,writable:!0,value:function(){return t(this,void 0,void 0,function(){var e,t,r,a,s,c,d,u,g;return o(this,function(o){switch(o.label){case 0:if(!x.token||!x.domain||!x.deviceId)return[2];if(!this.isRunning)return[2];if(this.lastPollDate&&(e=new Date(this.lastPollDate.getTime()+6e4),(t=(e.getTime()-Date.now())/1e3)>0))return this.scheduleNextPollEventsRequest(t),[2];this.lastPollDate=new Date,r=x.notificationsPaused||x.sdkIsOpen?"true":"false",a=new URLSearchParams(n(n({token:x.token,language:null!==(u=x.language)&&void 0!==u?u:"en",deviceId:x.deviceId,notificationsPaused:r,mode:x.mode},(null===(g=x.player)||void 0===g?void 0:g.id)?{unsignedPlayerId:x.player.id}:{}),x.signedMetadataToken?{signedMetadataToken:x.signedMetadataToken}:{})).toString(),o.label=1;case 1:return o.trys.push([1,4,,5]),[4,fetch("https://".concat(x.domain,"/api/sdk/events?").concat(a),{method:"GET"})];case 2:if(!(s=o.sent()).ok)throw new Error("HTTP error! status: ".concat(s.status));return[4,s.json()];case 3:return c=o.sent(),this.scheduleNextPollEventsRequest(c.nextPollSeconds),void 0!==c.pollWhenNotificationsEnabled&&(this.pollWhenNotificationsEnabled=c.pollWhenNotificationsEnabled),x.notifications=i(i([],x.notifications,!0),c.notifications,!0),x.notifications.length>0&&F(),c.unansweredMessageCount!==x.unansweredMessageCount&&(x.unansweredMessageCount=c.unansweredMessageCount,l("unansweredMessageCountUpdate",[c.unansweredMessageCount])),c.unreadMessageCount!==x.unreadMessageCount&&(x.unreadMessageCount=c.unreadMessageCount,l("unreadMessageCountUpdate",[c.unreadMessageCount]),H({action:"unreadMessageCountUpdate",count:c.unreadMessageCount})),[3,5];case 4:return d=o.sent(),console.error("Error fetching events:",d),this.scheduleNextPollEventsRequest(x.retryIntervalSecs),[3,5];case 5:return[2]}})})}}),e}(),W={eventPoller:null},z=function(){var e;null===(e=W.eventPoller)||void 0===e||e.onLogin()},G=function(){var e;null===(e=W.eventPoller)||void 0===e||e.onLogout()},Y=function(){var e;null===(e=W.eventPoller)||void 0===e||e.onOpen()},J=function(){var e;null===(e=W.eventPoller)||void 0===e||e.onClose()},K=function(){var e;null===(e=W.eventPoller)||void 0===e||e.onEnableNotifications()},X=function(){var e;null===(e=W.eventPoller)||void 0===e||e.onIsInForegroundChanged()},V=function(e){var n="/help-center";oe({path:n,config:e}),te({path:n,config:e})},Z=function(e){var n="/assistant";oe({path:n,config:e}),te({path:n,config:e})},Q=function(){!function(){var e=document.querySelector(v.sdkDialog),n=document.querySelector(v.sdkIframeWrapper);if(e){var t=function(){"widget"!==x.mode||x.forceUpdateSdkDialog?e.remove():e.style.display="none",x.forceUpdateSdkDialog=!1};n?(n.style.opacity="0",n.style.transform=le({animation:"start"}),setTimeout(function(){t()},200)):t()}x.widgetButton&&se();l("close",[])}()},$=function(){try{return CSS.supports("color","var(--color)")&&CSS.supports("color","rgb(255 255 255 / 0.5)")}catch(e){return!1}},ee=function(){for(var e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];a.apply(void 0,e)};function ne(e){var t,o,r,a,s,l,c=(null!=e?e:{}).config;if(!x.token||!x.domain||!x.deviceId)return null;var u=null!==(t=null==c?void 0:c.tags)&&void 0!==t?t:[],g=null!==(o=null==c?void 0:c.fields)&&void 0!==o?o:{},f=null!==(a=null!==(r=null==c?void 0:c.language)&&void 0!==r?r:x.language)&&void 0!==a?a:null,p=null!==(s=x.signedMetadataToken)&&void 0!==s?s:null,m=null!==(l=x.player)&&void 0!==l?l:null,v={_platform:h,_sdkVersion:d};x.youngPlayer&&(v._youngPlayer=!0),(x.privacyMode||x.youngPlayer)&&(v._privacyMode=!0);var y=i(i([],Array.from(x.tags),!0),u,!0),b=n(n(n({},x.fields),g),v);return{token:x.token,domain:x.domain,deviceId:x.deviceId,tags:y,fields:b,language:f,signedMetadataToken:p,player:m}}function te(e){var n,t,o,i=ne({config:e.config});if(i){var r=null!==(n=document.querySelector(v.sdkDialog))&&void 0!==n?n:document.createElement("div");r.id=v.sdkDialog.replace("#",""),r.style.display="block",r.style.position="fixed",r.style.border="none",r.style.width="0",r.style.height="0",r.style.margin="0",r.style.padding="0",r.style.zIndex="9998",r.style.overflow="hidden",r.style.backgroundColor="transparent";var a=null!==(t=r.querySelector(v.sdkIframeWrapper))&&void 0!==t?t:document.createElement("div");a.id=v.sdkIframeWrapper.replace("#",""),a.style.position="relative",a.style.width="100%",a.style.height="100%",a.style.top="0",a.style.right="0",a.style.bottom="0",a.style.left="0",a.style.opacity="0",a.style.colorScheme="auto",a.style.border="none",a.style.backgroundColor="rgb(".concat(L(x.colors.background),")"),a.style.transform=le({animation:"start"}),a.style.transition=(x.mode,"opacity ".concat(y,"s ease-in-out, transform ").concat(y,"s ease-in-out")),"widget"===x.mode&&(a.style.overflow="hidden");var s=null!==(o=a.querySelector(v.sdkLoaderIframe))&&void 0!==o?o:document.createElement("iframe");s.id=v.sdkLoaderIframe.replace("#",""),s.style.position="absolute",s.style.border="none",s.style.width="100%",s.style.height="100%",s.style.top="0",s.style.right="0",s.style.bottom="0",s.style.left="0",s.style.colorScheme="auto";var d=a.querySelector(v.sdkIframe),u=null!=d?d:document.createElement("iframe"),g=setInterval(function(){var e;"complete"===(null===(e=u.contentDocument)||void 0===e?void 0:e.readyState)&&(clearInterval(g),p())},500);u.id=v.sdkIframe.replace("#",""),u.style.position="absolute",u.style.border="none",u.style.top="0",u.style.right="0",u.style.bottom="0",u.style.left="0",u.style.colorScheme="auto",d&&!x.networkErrorTimerId||(u.src=function(e){var n=e.path,t=e.supportViewConfig,o="https://".concat(x.domain,"/sdk"),i=new URLSearchParams;i.set("platform",h),i.set("token",t.token),i.set("deviceId",t.deviceId),i.set("mode",x.mode),i.set("origin",window.location.origin),i.set("userLanguage",x.userLanguage),x.disableInsets&&i.set("disableInsets","true");t.language&&i.set("language",t.language);$()||i.set("unsupported","true");var r=re({supportViewConfig:t});return i.set("metadata",JSON.stringify(r)),"".concat(o).concat(n,"?").concat(i.toString())}({path:e.path,supportViewConfig:i}),u.style.width="0",u.style.height="0",r.appendChild(a),a.appendChild(s),a.appendChild(u),document.body.appendChild(r)),O({iframe:s,content:I({template:'<!DOCTYPE html>\n<html lang="en">\n\n<head>\n  <meta charset="utf-8" />\n  <meta name="viewport"\n    content="viewport-fit=cover, width=device-width, initial-scale=1.0, minimum-scale=1.0, maximum-scale=1.0, user-scalable=no" />\n  <meta name="theme-color" content="#000000" />\n  <meta name="robots" content="noindex" />\n  <title>Theymes</title>\n  <style NONCE_ATTR_PLACEHOLDER>\n    * {\n      box-sizing: border-box;\n    }\n\n    html,\n    body {\n      background: rgb(CSS_BACKGROUND_PLACEHOLDER);\n      width: 100%;\n      height: 100%;\n      margin: 0;\n      padding: 0;\n      -webkit-tap-highlight-color: transparent;\n      -webkit-touch-callout: none;\n      -webkit-user-select: none;\n      -khtml-user-select: none;\n      -moz-user-select: none;\n      -ms-user-select: none;\n      user-select: none;\n      touch-action: none;\n    }\n\n    .wrapper {\n      display: flex;\n      flex-direction: column;\n      width: 100%;\n      height: 100%;\n      padding-top: INSET_TOP_PLACEHOLDER;\n      padding-bottom: INSET_BOTTOM_PLACEHOLDER;\n      padding-left: INSET_LEFT_PLACEHOLDER;\n      padding-right: INSET_RIGHT_PLACEHOLDER;\n    }\n\n    .top-bar {\n      flex: 0 0 auto;\n      display: flex;\n      width: 100%;\n      align-items: center;\n      justify-content: flex-end;\n    }\n\n    .loader-wrapper {\n      flex: 1 0 0%;\n      display: flex;\n      flex-direction: column;\n      width: 100%;\n      height: 100%;\n      position: relative;\n      align-items: center;\n      justify-content: center;\n      text-align: center;\n      gap: 12px;\n    }\n\n    .close-button {\n      padding: 0.5rem 1rem;\n      cursor: pointer;\n    }\n\n    .close-button svg {\n      display: block;\n      stroke: rgb(CSS_ACCENT_PLACEHOLDER);\n      width: 1.75rem;\n      height: 1.75rem;\n    }\n\n    @keyframes spin {\n      to {\n        transform: rotate(360deg);\n      }\n    }\n\n    .loader {\n      stroke: rgb(CSS_ACCENT_PLACEHOLDER);\n      width: 2rem;\n      height: 2rem;\n      animation: spin 1s linear infinite;\n      transform-origin: center;\n    }\n  </style>\n</head>\n\n<body>\n  <noscript>You need to enable JavaScript to run this app.</noscript>\n  <div class="wrapper">\n    <div class="top-bar">\n      <div class="close-button">\n        <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none"\n          stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"\n          class="lucide lucide-x-icon lucide-x">\n          <path d="M18 6 6 18" />\n          <path d="m6 6 12 12" />\n        </svg>\n      </div>\n    </div>\n    <div class="loader-wrapper">\n      <svg class="loader" viewBox="0 0 38 38" xmlns="http://www.w3.org/2000/svg" fill="none" data-test-name="oval"\n        role="img">\n        <g fill="none" fill-rule="evenodd">\n          <g transform="translate(1 1)" stroke-width="2">\n            <circle stroke-opacity="0.5" cx="18" cy="18" r="18" />\n            <path d="M36 18c0-9.94-8.06-18-18-18" />\n          </g>\n        </g>\n      </svg>\n    </div>\n  </div>\n  <script NONCE_ATTR_PLACEHOLDER>\n    function closeTheymesSdk() {\n      parent.postMessage({ action: \'theymes.close\' }, \'*\');\n    }\n\n    document.querySelector(\'.close-button\').addEventListener(\'click\', closeTheymesSdk);\n  <\/script>\n</body>\n\n</html>'})});var f=!1,p=function(){f||(f=!0,x.networkErrorTimerId=setTimeout(function(){O({iframe:s,content:I({template:c})})},1e4))};u.onload=p,u.onerror=function(){O({iframe:s,content:I({template:c})})},ae(),l("open",[]),setTimeout(function(){a.style.opacity="1",a.style.transform=le({animation:"end"})},100)}}function oe(e){var n=e.path,t=e.config,o=null!=t?t:null;x.previousPath===n&&C(x.previousConfig,o)||(x.previousPath=n,x.previousConfig=o,ie())}function ie(){var e=document.querySelector(v.sdkDialog);x.sdkIsOpen?x.forceUpdateSdkDialog=!0:null==e||e.remove()}function re(e){var n=e.supportViewConfig,t={unsigned:{},signed:void 0};return n.player&&(t.unsigned.player=n.player),n.tags&&(t.unsigned.tags=n.tags),n.fields&&(t.unsigned.fields=n.fields),n.signedMetadataToken&&(t.signed=n.signedMetadataToken),t}function ae(){var e=document.querySelector(v.sdkDialog),n=document.querySelector(v.sdkIframeWrapper);if(e&&n)if("widget"===x.mode){var t=B({type:"widget"}),o=M();e.style.width=o.width,e.style.height=o.height,e.style.maxWidth=o.maxWidth,e.style.maxHeight=o.maxHeight,e.style.bottom=t.bottom,e.style.right=t.right,e.style.left=t.left,e.style.top=t.top,D()?(n.style.border="none",n.style.borderRadius="0"):(n.style.border="1px solid rgb(".concat(L(x.colors.border),")"),n.style.borderRadius="10px")}else if(n.style.border="none",n.style.borderRadius="0",x.element){var i=x.element.getBoundingClientRect(),r=i.width,a=i.height,s=i.top,l=i.left,c=i.right,d=i.bottom;e.style.width="".concat(r,"px"),e.style.height="".concat(a,"px"),e.style.maxWidth="none",e.style.maxHeight="none",e.style.top="".concat(s,"px"),e.style.left="".concat(l,"px"),e.style.right="".concat(c,"px"),e.style.bottom="".concat(d,"px")}else{a=x.keyboardHeight>0?"calc(100% - ".concat(x.keyboardHeight,"px + env(safe-area-inset-bottom) - 10px)"):"100%";e.style.width="100%",e.style.height=a,e.style.maxWidth="none",e.style.maxHeight="none",e.style.top="0",e.style.left="0",e.style.right="0",e.style.bottom="0"}}function se(){var e,n=null!==(e=document.querySelector(v.sdkButtonIframe))&&void 0!==e?e:document.createElement("iframe");if(n){var t,o=B({type:"button"});n.id=v.sdkButtonIframe.replace("#",""),n.style.position="fixed",n.style.border="none",n.style.width="".concat(120,"px"),n.style.height="".concat(48,"px"),n.style.minWidth="".concat(120,"px"),n.style.maxWidth="95%",n.style.maxHeight="95%",n.style.bottom=o.bottom,n.style.right=o.right,n.style.left=o.left,n.style.top=o.top,n.style.margin="0",n.style.padding="0",n.style.zIndex="9997",n.style.backgroundColor="transparent",n.style.opacity="0",n.style.transform="scale(0.8)",n.style.transition="opacity ".concat(.2,"s ease-in-out, transform ").concat(.2,"s ease-in-out"),setTimeout(function(){n.style.opacity="1",n.style.transform="scale(1)"},100),document.body.appendChild(n),O({iframe:n,content:(t={unreadMessageCount:x.unreadMessageCount},I({template:"<!DOCTYPE html>\n<html lang=\"en\">\n\n<head>\n  <meta charset=\"utf-8\" />\n  <meta name=\"viewport\"\n    content=\"viewport-fit=cover, width=device-width, initial-scale=1.0, minimum-scale=1.0, maximum-scale=1.0, user-scalable=no\" />\n  <meta name=\"theme-color\" content=\"#000000\" />\n  <meta name=\"robots\" content=\"noindex\" />\n  <title>Theymes</title>\n  <style NONCE_ATTR_PLACEHOLDER>\n    @font-face {\n      font-family: 'TheymesBody';\n      src: CSS_BODY_FONT_NORMAL_SRC_PLACEHOLDER;\n      font-weight: normal;\n      font-style: normal;\n      font-display: fallback;\n    }\n\n    * {\n      box-sizing: border-box;\n    }\n\n    html,\n    body {\n      width: 100%;\n      height: 100%;\n      margin: 0;\n      padding: 0;\n      -webkit-tap-highlight-color: transparent;\n      -webkit-touch-callout: none;\n      -webkit-user-select: none;\n      -khtml-user-select: none;\n      -moz-user-select: none;\n      -ms-user-select: none;\n      user-select: none;\n      touch-action: none;\n    }\n\n    .sdk-button {\n      display: flex;\n      font-family: 'TheymesBody', CSS_BODY_FALLBACK_FONT_FAMILY_PLACEHOLDER;\n      background: rgb(CSS_WIDGET_BUTTON_BACKGROUND_PLACEHOLDER);\n      width: 100%;\n      height: 100%;\n      align-items: center;\n      justify-content: center;\n      color: rgb(CSS_WIDGET_BUTTON_TEXT_PLACEHOLDER);\n      font-size: 14px;\n      font-weight: 700;\n      cursor: pointer;\n      text-align: center;\n      padding: 0;\n      border: none;\n      outline: none;\n      border-radius: 999px;\n      box-shadow: 0 0 10px 0 rgba(0, 0, 0, 0.1);\n      position: relative;\n      white-space: nowrap; \n    }\n\n    .sdk-button-text {\n      overflow: hidden;\n      text-overflow: ellipsis;\n    }\n\n    .sdk-button-badge {\n      position: absolute;\n      top: 0;\n      right: 0;\n      background: rgb(CSS_WIDGET_BUTTON_ACTION_PENDING_PLACEHOLDER);\n      width: 12px;\n      height: 12px;\n      border-radius: 999px;\n      display: none;\n    }\n  </style>\n</head>\n\n<body>\n  <noscript>You need to enable JavaScript to run this app.</noscript>\n  <button class=\"sdk-button\">\n    <span class=\"sdk-button-text\">WIDGET_BUTTON_TEXT_PLACEHOLDER</span>\n    <span class=\"sdk-button-badge\"></span>\n  </button>\n  <script NONCE_ATTR_PLACEHOLDER>\n    let unreadMessageCount = UNREAD_MESSAGE_COUNT_PLACEHOLDER;\n\n    function calculateButtonSize() {\n      const paddingX = 12;\n      const scrollWidth = document.querySelector('.sdk-button-text').scrollWidth;\n      const width = scrollWidth + (paddingX * 2);\n      \n      parent.postMessage({ action: 'theymes.sdkButtonSizeUpdated', width }, '*');\n    }\n\n    function openWidget() {\n      parent.postMessage({ action: 'theymes.sdkButtonClicked' }, '*');\n    }\n\n    function iframeSubscriber(e) {\n      if (e.data.action === 'unreadMessageCountUpdate') {\n        unreadMessageCount = e.data.count;\n        updateUnreadMessageCount()\n      } else if (e.data.action === 'widgetButtonTextUpdate') {\n        document.querySelector('.sdk-button-text').innerHTML = e.data.text;\n        calculateButtonSize();\n      }\n    }\n\n    function updateUnreadMessageCount() {\n      if (unreadMessageCount > 0) {\n        document.querySelector('.sdk-button-badge').style.display = 'block';\n      } else {\n        document.querySelector('.sdk-button-badge').style.display = 'none';\n      }\n    }\n\n    document.querySelector('.sdk-button').addEventListener('click', openWidget);\n    window.addEventListener('message', iframeSubscriber, false);\n\n    updateUnreadMessageCount();\n    calculateButtonSize();\n  <\/script>\n</body>\n\n</html>"}).replace(/UNREAD_MESSAGE_COUNT_PLACEHOLDER/g,"".concat(t.unreadMessageCount)).replace(/CSS_WIDGET_BUTTON_BACKGROUND_PLACEHOLDER/g,L(x.colors.widgetButtonBackground)).replace(/CSS_WIDGET_BUTTON_TEXT_PLACEHOLDER/g,L(x.colors.widgetButtonText)).replace(/CSS_WIDGET_BUTTON_ACTION_PENDING_PLACEHOLDER/g,L(x.colors.widgetButtonActionPending)).replace(/WIDGET_BUTTON_TEXT_PLACEHOLDER/g,me()))})}}function le(e){return"start"===e.animation?"game"===x.mode?"translateY(20%)":"scale(0.8)":"game"===x.mode?"translateY(0)":"scale(1)"}function ce(e){return t(this,void 0,void 0,function(){return o(this,function(n){switch(n.label){case 0:return n.trys.push([0,2,,7]),[4,e.json()];case 1:return[2,n.sent()];case 2:n.sent(),n.label=3;case 3:return n.trys.push([3,5,,6]),[4,e.text()];case 4:return[2,n.sent()];case 5:return n.sent(),[2,void 0];case 6:return[3,7];case 7:return[2]}})})}function de(){return t(this,void 0,void 0,function(){var e,n,t,i,r,a;return o(this,function(o){switch(o.label){case 0:if(fe(),x.retryRecordRetentionTimerId&&(clearTimeout(x.retryRecordRetentionTimerId),x.retryRecordRetentionTimerId=null),x.retentionRemainingSeconds=null,x.isRetentionRecordedForSession=!0,!(e=ne()))return[2];n="https://".concat(x.domain,"/api/sdk/retention"),t=re({supportViewConfig:e}),i={token:x.token,deviceId:x.deviceId,language:x.language,metadata:t},o.label=1;case 1:return o.trys.push([1,5,,6]),[4,fetch(n,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(i)})];case 2:return(r=o.sent()).ok?[3,4]:[4,ce(r)];case 3:throw o.sent();case 4:return[3,6];case 5:return a=o.sent(),console.error("Error tracking retention:",a),x.retryRecordRetentionTimerId=setTimeout(de,6e4),[3,6];case 6:return[2]}})})}function ue(){var e=new Date;if(x.sessionStatus="active",x.sessionResumeOrStartTime=e,x.sessionStartTime){var n=x.sessionStartTime.valueOf()/1e3+x.resetSessionAfterSecs;Date.now()/1e3>n&&ge()}else ge();null!==x.retentionRemainingSeconds&&(x.recordRetentionTimerId=setTimeout(de,1e3*x.retentionRemainingSeconds))}function ge(){x.sessionStartTime=new Date,x.retentionRemainingSeconds=x.recordRetentionAfterSecs,x.isRetentionRecordedForSession=!1,fe()}function fe(){x.recordRetentionTimerId&&(clearTimeout(x.recordRetentionTimerId),x.recordRetentionTimerId=null)}function pe(){x.isRetentionRecordedForSession&&de()}function me(){var e;return function(e){var n=e.split(" ");if(e.length<=16||n.length<=1)return e;for(var t=n.map(function(e){return e.length}),o=[],r=1;r<t.length;r++){var a=t.slice(0,r),s=t.slice(r),l=a.reduce(function(e,n){return e+n},0),c=s.reduce(function(e,n){return e+n},0),d=Math.abs(l-c);o.push(d)}var u=Math.min.apply(Math,o),g=o.indexOf(u);return i(i(i([],n.slice(0,g+1),!0),["<br>"],!1),n.slice(g+1),!0).join(" ")}(null!==(e=function(e){var n,t,o,i,r,a=R(null!==(n=x.language)&&void 0!==n?n:"en"),s=null===(t=x.locs[e.loc])||void 0===t?void 0:t[a];if(s)return s;var l=a.split("-")[0];return l&&(null===(o=x.locs[e.loc])||void 0===o?void 0:o[l])||(null!==(r=null===(i=x.locs[e.loc])||void 0===i?void 0:i.en)&&void 0!==r?r:null)}({loc:"widgetButtonText"}))&&void 0!==e?e:"Support")}function he(){var e=x.isInForeground,n="visible"===document.visibilityState&&document.hasFocus();x.isInForeground=n,e!==n&&X(),n&&"paused"===x.sessionStatus?ue():n||"active"!==x.sessionStatus||function(){if(x.sessionResumeOrStartTime&&x.retentionRemainingSeconds){var e=Math.floor((Date.now()-x.sessionResumeOrStartTime.valueOf())/1e3);x.retentionRemainingSeconds-=e}x.sessionStatus="paused",fe()}()}function ve(){var e,n=x.isLoggedIn,t=Boolean(x.signedMetadataToken||(null===(e=x.player)||void 0===e?void 0:e.id));x.isLoggedIn=t,t&&!n?z():!t&&n&&G()}try{document.addEventListener("visibilitychange",he),window.addEventListener("focus",he),window.addEventListener("blur",he),window.addEventListener("resize",ae),window.addEventListener("resize",j),window.addEventListener("message",function(e){if("theymes.ready"===e.data.action){var n=document.querySelector(v.sdkLoaderIframe),t=document.querySelector(v.sdkIframe);x.networkErrorTimerId&&(clearTimeout(x.networkErrorTimerId),x.networkErrorTimerId=null),t&&(t.style.width="100%",t.style.height="100%"),n&&n.remove()}else if("theymes.close"===e.data.action)Q();else if("theymes.closeNotification"===e.data.action)U({notification:x.visibleNotification});else if("theymes.handleNotificationAction"===e.data.action)a={notification:x.visibleNotification},(null==(s=a.notification)?void 0:s.action)&&"OPEN_PAGE"===s.action.type&&(te({path:s.action.path}),U({notification:s}));else if("theymes.sdkButtonClicked"===e.data.action)(r=document.querySelector(v.sdkButtonIframe))&&(r.style.opacity="0",r.style.transform="scale(0.8)",setTimeout(function(){r.remove()},200)),"support"===x.widgetButtonAction?V():"assistant"===x.widgetButtonAction&&Z();else if("theymes.sdkButtonSizeUpdated"===e.data.action){var o=document.querySelector(v.sdkButtonIframe);o&&(o.style.width="".concat(e.data.width,"px"))}else if("theymes.openExternalPage"===e.data.action){var i=e.data.target;"_self"===i&&function(e){var n=e.key,t=e.value,o=e.ttlMs,i=e.storage,r=void 0===i?E:i,a={value:t,expiry:Date.now()+o};r.setItem(n,JSON.stringify(a))}({key:b,value:e.data.path,ttlMs:6e5}),window.open(e.data.url,i)}var r,a,s},!1),ee("open",function(){x.sdkIsOpen=!0,Y()}),ee("close",function(){x.sdkIsOpen=!1,J()})}catch(e){console.error("Error adding event listeners to SDK",e)}var ye=_("initialize",function(e,i,r){return t(void 0,void 0,void 0,function(){var t,a,s,l,c,d,v,y,T,k,C,O,L,I;return o(this,function(o){switch(o.label){case 0:if(!e||!i||!r.mode)throw new Error("Token, domain, and mode are required");x.token=e,x.domain=i,x.mode=r.mode,x.element="element"in r&&void 0!==r.element?r.element:x.element,x.language=null!==(v=r.language)&&void 0!==v?v:x.language,x.nonce=null!==(y=r.nonce)&&void 0!==y?y:x.nonce,x.deviceId=function(){var e=w("deviceId");if(e)return e;var n=(t=Date.now(),"undefined"!=typeof performance&&"function"==typeof performance.now&&(t+=performance.now()),"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(e){var n=(t+16*Math.random())%16|0;return t=Math.floor(t/16),("x"===e?n:3&n|8).toString(16)}));return S("deviceId",n),n;var t}(),x.widgetButton="button"in r&&void 0!==r.button&&null!==(T=r.button)&&void 0!==T?T:x.widgetButton,x.widgetButtonAction="buttonAction"in r&&void 0!==r.buttonAction&&null!==(k=r.buttonAction)&&void 0!==k?k:x.widgetButtonAction,x.position="position"in r&&void 0!==r.position&&null!==(C=r.position)&&void 0!==C?C:x.position,x.x="x"in r&&void 0!==r.x?r.x:x.x,x.y="y"in r&&void 0!==r.y?r.y:x.y,x.disableInsets="game"===x.mode&&null!==x.element,W.eventPoller||(W.eventPoller=new q),t="https://".concat(i,"/api/sdk/settings"),a=new URLSearchParams({token:x.token,platform:h,mode:x.mode}).toString(),o.label=1;case 1:return o.trys.push([1,6,,7]),[4,fetch("".concat(t,"?").concat(a),{method:"GET"})];case 2:return(s=o.sent()).ok?[3,4]:[4,ce(s)];case 3:throw o.sent();case 4:return[4,s.json()];case 5:return l=o.sent(),(null===(O=null==l?void 0:l.branding)||void 0===O?void 0:O.colors)&&(N=l.branding.colors,x.colors=n(n({},x.colors),N),S(u,JSON.stringify(x.colors))),(null===(L=null==l?void 0:l.branding)||void 0===L?void 0:L.locs)&&(A=l.branding.locs,x.locs=n(n({},x.locs),A),S(g,JSON.stringify(x.locs))),(null===(I=null==l?void 0:l.branding)||void 0===I?void 0:I.fonts)&&(P=l.branding.fonts,x.fonts=n(n({},x.fonts),P),S(f,JSON.stringify(x.fonts))),"number"!=typeof(null==l?void 0:l.recordRetentionAfterSecs)&&null!==(null==l?void 0:l.recordRetentionAfterSecs)||(R=l.recordRetentionAfterSecs,x.recordRetentionAfterSecs=R,S(p,JSON.stringify(x.recordRetentionAfterSecs))),"number"!=typeof(null==l?void 0:l.resetSessionAfterSecs)&&null!==(null==l?void 0:l.resetSessionAfterSecs)||(_=l.resetSessionAfterSecs,x.resetSessionAfterSecs=null!=_?_:28800,S(m,JSON.stringify(x.resetSessionAfterSecs))),ue(),ie(),c=function(e){var n=e.key,t=e.storage,o=void 0===t?E:t,i=e.removeItem,r=void 0!==i&&i,a=o.getItem(n);if(!a)return null;var s=JSON.parse(a);return Date.now()>s.expiry?(o.removeItem(n),null):(r&&o.removeItem(n),s.value)}({key:b,removeItem:!0}),c&&"widget"===x.mode&&!D()?te({path:c}):x.widgetButton&&se(),[3,7];case 6:return d=o.sent(),console.error("Error initializing SDK:",d),[3,7];case 7:return[2]}var _,R,P,A,N})})},void 0),be=_("openSupport",V,void 0),we=_("openAssistant",Z,void 0),Se=_("openResource",function(e,n){var t="/resources/".concat(e);oe({path:t,config:n}),te({path:t,config:n})},void 0),Ee=_("close",Q,void 0),xe=_("getLanguage",function(){return x.language},null),Te=_("setLanguage",function(e){var n=x.language!==e;x.language=e,n&&(ie(),H({action:"widgetButtonTextUpdate",text:me()}))},void 0),ke=_("getSignedMetadataToken",function(){return x.signedMetadataToken},null),Ce=_("setSignedMetadataToken",function(e){var n=x.signedMetadataToken!==e;x.signedMetadataToken=e,ve(),n&&(ie(),pe())},void 0),Oe=_("getPlayer",function(){return x.player},null),Le=_("setPlayer",function(e){var n,t=(null===(n=x.player)||void 0===n?void 0:n.id)!==(null==e?void 0:e.id);x.player=e,ve(),t&&(ie(),pe())},void 0),Ie=_("getTags",function(){return Array.from(x.tags)},[]),_e=_("setTags",function(e){x.tags=new Set(e),ie()},void 0),Re=_("addTag",function(e){x.tags.add(e),ie()},void 0),Pe=_("addTags",function(e){e.forEach(function(e){return x.tags.add(e)}),ie()},void 0),Ae=_("removeTag",function(e){x.tags.delete(e),ie()},void 0),Ne=_("removeTags",function(e){e.forEach(function(e){return x.tags.delete(e)}),ie()},void 0),De=_("removeAllTags",function(){x.tags.clear(),ie()},void 0),Be=_("getFields",function(){return x.fields},{}),Me=_("setFields",function(e){x.fields=e,ie()},void 0),He=_("addField",function(e,n){x.fields[e]=n,ie()},void 0),Fe=_("addFields",function(e){x.fields=n(n({},x.fields),e),ie()},void 0),je=_("removeField",function(e){delete x.fields[e],ie()},void 0),Ue=_("removeFields",function(e){e.forEach(function(e){return delete x.fields[e]}),ie()},void 0),qe=_("removeAllFields",function(){x.fields={},ie()},void 0),We=_("enableLogging",function(){x.loggingEnabled=!0},void 0),ze=_("disableLogging",function(){x.loggingEnabled=!1},void 0),Ge=_("isYoungPlayer",function(){return x.youngPlayer},!1),Ye=_("setYoungPlayer",function(e){x.youngPlayer=e,ie()},void 0),Je=_("isPrivacyMode",function(){return x.privacyMode},!1),Ke=_("setPrivacyMode",function(e){x.privacyMode=e,ie()},void 0),Xe=_("isSupported",$,!1),Ve=_("requestNotificationPermission",function(){},void 0),Ze=_("enableNotifications",function(){x.notificationsPaused=!1,K()},void 0),Qe=_("disableNotifications",function(){x.notificationsPaused=!0},void 0),$e=_("getUnreadMessageCount",function(){return x.unreadMessageCount},0),en=_("getUnansweredMessageCount",function(){return x.unansweredMessageCount},0),nn=_("getSdkVersion",function(){return d},""),tn=_("reset",function(){x.language=null,x.tags=new Set,x.fields={},x.signedMetadataToken=null,x.player=null,ve(),ie(),H({action:"widgetButtonTextUpdate",text:me()})},void 0),on=_("recordRetention",function(){x.isRetentionRecordedForSession||de()},void 0),rn=_("addEventListener",ee,void 0),an=_("removeEventListener",function(){for(var e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];s.apply(void 0,e)},void 0),sn=_("iosSetKeyboardHeight",function(e){x.keyboardHeight=e,ae()},void 0);e.addEventListener=rn,e.addField=He,e.addFields=Fe,e.addTag=Re,e.addTags=Pe,e.close=Ee,e.disableLogging=ze,e.disableNotifications=Qe,e.enableLogging=We,e.enableNotifications=Ze,e.getFields=Be,e.getLanguage=xe,e.getPlayer=Oe,e.getSdkVersion=nn,e.getSignedMetadataToken=ke,e.getTags=Ie,e.getUnansweredMessageCount=en,e.getUnreadMessageCount=$e,e.initialize=ye,e.iosSetKeyboardHeight=sn,e.isPrivacyMode=Je,e.isSupported=Xe,e.isYoungPlayer=Ge,e.openAssistant=we,e.openResource=Se,e.openSupport=be,e.recordRetention=on,e.removeAllFields=qe,e.removeAllTags=De,e.removeEventListener=an,e.removeField=je,e.removeFields=Ue,e.removeTag=Ae,e.removeTags=Ne,e.requestNotificationPermission=Ve,e.reset=tn,e.setFields=Me,e.setLanguage=Te,e.setPlayer=Le,e.setPrivacyMode=Ke,e.setSignedMetadataToken=Ce,e.setTags=_e,e.setYoungPlayer=Ye}(this.theymes=this.theymes||{});
